const fs = require("fs");
const path = require("path");

const artifactPath = path.join(__dirname, "../artifacts/contracts/Game(updated).sol/TicTacToe.json");
const outPath = path.join(__dirname, "../tictactoe-bytecode.js");

if (!fs.existsSync(artifactPath)) {
  console.error("Run 'npx hardhat compile' first (Game(updated).sol).");
  process.exit(1);
}

const artifact = JSON.parse(fs.readFileSync(artifactPath, "utf8"));
const bytecode = artifact.bytecode || artifact.deployedBytecode?.object || "";
if (!bytecode) {
  console.error("No bytecode in TicTacToe artifact.");
  process.exit(1);
}

const content = `// Generated by scripts/export-tictactoe-bytecode.js â€” do not edit by hand
window.TICTACTOE_BYTECODE = "${bytecode}";
`;
fs.writeFileSync(outPath, content);
console.log("Written tictactoe-bytecode.js");
